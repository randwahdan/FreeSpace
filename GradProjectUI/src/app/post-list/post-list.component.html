<div  *ngFor="let post of postModelList">
  <div class="card gedf-card">
    <div class="card-header">
      <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center"> <!-- Use align-items-center to vertically center the content -->
          <div class="mr-3" >
            <img class="rounded-circle" width="45" *ngIf="post && post.profilePicture" [src]="post.profilePicture" alt="">
          </div>
          <div class="ml-3" style="margin-left: 6px;">
            <div class="h5 m-0"></div>
            <div class="h6 text-muted">{{ post.fullName }}</div>
          </div>
          </div>
        </div>
      </div>


      <div class="card-body">
          <div class="text-muted h7 mb-2"> <i class="fa fa-clock-o"></i> <span>{{post.createdDate |date:'dd/MM/yyyy HH:mm'}}</span></div>
          <p class="card-text">
            {{post.content}}
          </p>
      </div>

      <div class="carousel-container" *ngIf="post.media && post.media.length > 0">
        <ngb-carousel #carousel="ngbCarousel" class="custom-carousel">
          <ng-template ngbSlide *ngFor="let media of post.media">
            <ng-container *ngIf="isVideo(media)">
              <video class="d-block w-100 post-video" controls>
                <source [src]="media?.url">
                Your browser does not support the video tag.
              </video>
            </ng-container>
            <ng-container *ngIf="!isVideo(media)">
              <img class="d-block w-100 post-img" [src]="media?.url" alt="Slide">
            </ng-container>
          </ng-template>
        </ngb-carousel>

        <!-- Custom carousel navigation controls -->
        <div class="custom-carousel-controls" *ngIf="post.media.length > 1">
          <button (click)="carousel.prev()" class="carousel-control prev" aria-label="Previous">
            <i class="fa fa-chevron-left"></i>
          </button>
          <button (click)="carousel.next()" class="carousel-control next" aria-label="Next">
            <i class="fa fa-chevron-right"></i>
          </button>
        </div>
      </div>
      <div class="card-footer">
        <div class="activity-icons">
          <div *ngIf="post.isLiked" (click)="makeDislike(post)" class="card-link">
            <img src="assets/image/icons/icons8-like-32.png" alt="">
            {{ post.likesCount }} Like
          </div>
          <div *ngIf="!post.isLiked" (click)="makeLike(post)" class="card-link">
            <img src="assets/image/icons/icons8-facebook-like-32.png" alt="">
            {{ post.likesCount }} Likes
          </div>
          <div (click)="toggleCommentSection(post.postId)" class="card-link">
            <img *ngIf="isCommentSectionVisible(post.postId)" src="assets/image/icons/icons8-chat-bubble-32.png" alt="Comment">
            <img *ngIf="!isCommentSectionVisible(post.postId)" src="assets/image/icons/icons8-chat-bubble-32 (1).png" alt="Close Comment">
            {{ post.comments.length }} Comments
          </div>
        </div>

        <div *ngIf="isCommentSectionVisible(post.postId)" class="container mt-5 mb-5">
          <!-- Comment section content here -->
          <div class="card">
            <div class="p-3">
              <h6>Comments</h6>
            </div>
            <div class="mt-3 d-flex flex-row align-items-center p-3 form-color">
              <img [src]="user.profilePicture" width="50" class="rounded-circle mr-2">
              <form [formGroup]="commentForm" (ngSubmit)="addComment(post)" class="d-flex flex-grow-1">
                <div class="input-group flex-grow-1">
                  <input type="text" class="form-control" placeholder="Write a comment..." formControlName="content">
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Add Comment</button>
                  </div>
                </div>
              </form>
            </div>
            <div class="mt-2">
              <!-- Loop through comments -->
              <div *ngFor="let comment of post.comments.slice().reverse(); let i = index" class="d-flex flex-row p-3 comment-item">
                <img src="{{ comment.profilePicture }}" width="40" height="40" class="rounded-circle mr-3">
                <div class="w-100">
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="d-flex flex-row align-items-center">
                      <span class="mr-2">{{ comment.fullName }}</span>
                      <small class="c-badge" *ngIf="i === 0">Last Comment</small>
                    </div>
                    <small>{{ comment.createdDate | date:'dd/MM/yyyy HH:mm' }}</small>
                  </div>
                  <p class="text-justify comment-text mb-0">{{ comment.content }}</p>
                </div>
              </div>
              <!-- COMMENT - END -->
            </div>
          </div>
        </div>
      </div>
    </div>
